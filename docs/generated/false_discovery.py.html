<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>
  <head>
    <title>false_discovery.py</title>
  </head>
  <body>
    <h1>false_discovery.py</h1>
<h2>Overview</h2>
<pre>

  false_discovery.py takes as input a desired false discovery rate and
  a Pmap, and produces the cutoff P score for the requested rate.

  false_discovery.py [--independent] qrate pmap

    --independent indicates that independent sample statistics are 
      to be used.  (This is not generally appropriate)
    qrate is a desired false discovery rate
    pmap is a map of p-scores in Pgh MRI format

  or

  false_discovery.py -help [topic]

</pre>
<h2>Details</h2>
<pre>

  This is an implementation of the algorithms described in 
  "Thresholding of Statistical Maps in Functional Neuroimaging
  Using the False Discovery Rate" by C. R. Genovese, N.A. Lazar, 
  and T. Nichols .  A technical report version of the paper is 
  available from the Reference section of
  http://www.stat.cmu.edu/~fiasco .

  There are special floating point values in the IEEE standard for
  floating point numbers which represent "not a number" or "infinite"
  values;  false_discovery.py ignores those entries when it calculates
  the P score cutoff.  This means that you can mask out parts of the
  input data that you would like to ignore by setting them equal to
  "NaN" using (for example) mri_rpn_math.

</pre>
<h2>Example</h2>
<pre>

  A shell script would typically use false_discovery.py to generate
  a P score cutoff, and then mask the Pmap using that threshold.  
  For example, using the Fiasco "overlay" utility:

    set val = `false_discovery.py 0.15 Pmap`

    overlay.csh -inmap Pmap -inimage mean_image -headerout masked_p 
      -highthresh 2.0 -lowthresh $val

  The high threshold is an impossible P score of 2.0; the low
  threshold is inferred from the desired false discovery rate.

  Sometimes results can be improved by considering only part of the
  input Pmap, for example only the area inside the head.  If you have
  a dataset called "mean" which you believe has values greater than 50
  inside the head, you could do the following to compute the false
  discovery cutoff using only that area:

    mri_rpn_math -o Pmap_masked '$1,NaN,$2,50,&gt;,if_keep' Pmap mean

    set val = `false_discovery.py 0.15 Pmap_masked`

</pre>
<h2>Environment</h2>
<pre>

  false_discovery.py keeps scratch files in a temporary directory.
  If the environment variable F_TEMP is defined this directory will 
  be ${F_TEMP}/tmp_fd_NN (where NN is the current process ID);
  otherwise ./tmp_fd_NN will be used.  The temporary directory is
  deleted when false_discovery.py is finished with it.

</pre>
    <hr>
    (automatically generated by false_discovery.py version of Mon Jul 15 00:18:47 2019)
  </body>
</html>
